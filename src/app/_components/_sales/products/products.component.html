<!-- duplicate product -->
<ng-template #dupdialog>
    <h1 mat-dialog-title >Duplicate Product</h1>
    <div mat-dialog-content>
      Would you like to duplicate <span class="global">{{product.name}}</span> product?
    </div>
    <div mat-dialog-actions class="justify-content-end">
      <button mat-button mat-dialog-close cdkFocusInitial class="text-danger">No</button>
      <button mat-button mat-dialog-close (click)="duplicateproduct(product)"  [color]="'primary'">Yes</button>
    </div>
  </ng-template>
  <!-- duplicate product -->
  <!-- delete product -->
  <ng-template #deldialog>
      <h1 mat-dialog-title class="kb-danger">Delete Product</h1>
      <div mat-dialog-content>
        Would you like to delete <span class="text-danger">{{product.name}}</span> product?
      </div>
      <div mat-dialog-actions class="justify-content-end">
        <button mat-button mat-dialog-close cdkFocusInitial [color]="'primary'">No</button>
        <button mat-button mat-dialog-close (click)="deleteproduct()" class="text-danger">Yes</button>
      </div>
    </ng-template>
    <!-- delete product -->
    <!-- Add new product -->
    <ng-template #adddialog>
      <h1 mat-dialog-title>Add Product</h1>
      <div mat-dialog-content>
        <mat-form-field class="kb-full-width" appearance="fill" [class.mat-form-field-invalid]="hasError">
          <mat-label>Name</mat-label>
          <input matInput type="text" placeholder="product name" [(ngModel)]="product.name" required [minlength]="3">
        </mat-form-field>
        <mat-form-field class="kb-full-width" appearance="fill" [class.mat-form-field-invalid]="hasError">
          <mat-label>Title</mat-label>
          <input matInput type="text" placeholder="title name" [(ngModel)]="product.title" required [minlength]="3">
        </mat-form-field>
        <mat-error *ngIf="hasError">{{hasError}}</mat-error>
        <mat-form-field class="kb-full-width" appearance="fill" [class.mat-form-field-invalid]="hasError">
          <mat-label>Description</mat-label>
          <input matInput type="text" placeholder="description" [(ngModel)]="product.description" required [minlength]="3">
        </mat-form-field>
        <mat-form-field class="kb-full-width" appearance="fill" [class.mat-form-field-invalid]="hasError">
          <mat-label>Thumbnail</mat-label>
          <input matInput type="text" placeholder="thumbnail" [(ngModel)]="product.thumbnail" required [minlength]="3">
        </mat-form-field>
        <mat-form-field class="kb-full-width" appearance="fill" [class.mat-form-field-invalid]="hasError">
          <mat-label> Type</mat-label>
          <mat-select [(ngModel)]="product.type" required>
              <mat-option value="physical">Physical</mat-option>
              <mat-option value="virtual">Virtual</mat-option>
          </mat-select>
        </mat-form-field>
        
      </div>
      <div mat-dialog-actions class="float-right">
          <button mat-button mat-dialog-close class="text-danger">Cancel</button>
          <button mat-button  (click)="addproduct()" cdkFocusInitial color="primary">Add</button>
      </div>
    </ng-template>
    <!-- Add new product -->
    <div class="container-fluid">
        <mat-progress-bar *ngIf="fetching" mode='indeterminate'></mat-progress-bar>
        <div class="row">
            <mat-form-field appearance="fill" class="col-md-4">
                <mat-label>Search products</mat-label>
                <input matInput #searchInp (input)="searchproducts(searchInp, sortInp)" type="text" placeholder="Search products">
                <i class="fa-solid fa-magnifying-glass"></i>
            </mat-form-field>
            <mat-form-field appearance="fill" class="col-md-3">
                <mat-label>Sort By</mat-label>
                <mat-select #sortInp name="kbfilter" value='created_at DESC' (valueChange)="searchproducts(searchInp, sortInp)">
                    <mat-option [value]="'created_at ASC'">ASC By Create</mat-option>
                    <mat-option [value]="'created_at DESC'">DESC By Create</mat-option>
                    <mat-option [value]="'updated_at ASC'">ASC By Update</mat-option>
                    <mat-option [value]="'updated_at DESC'">DESC By Update</mat-option>
                    <mat-option [value]="'name ASC'">ASC By Name</mat-option>
                  <mat-option [value]="'name DESC'">DESC By Name</mat-option>
                </mat-select>
            </mat-form-field>
            <div class="col-md-5 text-right mt-2">
                <button mat-raised-button (click)="openDialog(adddialog, product)" color="primary" class="mx-3">Add product <i
                    class="fas fa-plus"></i></button>
            </div>
        </div>
        <div class="row">
          <div class="col-12">
            <table class="table kb-table">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Type</th>
                  <th>Title</th>
                  <th>Created</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let product of products; index as i">
                  <td [routerLink]="['/sales/product/'+product.uniqueid]" class="kb-td-link"><span>{{(product.name) | titlecase}}</span></td>
                  <td [routerLink]="['/sales/product/'+product.uniqueid]" class="kb-td-link"><span class="text-lowercase">{{ product.type | lowercase }}</span></td>
                  <td>{{ product.title | lowercase}}</td>
                  <td>{{ product.created_at | date:'medium' }}</td>
                  <td>
                    <span class="d-flex">
                      <i mat-ripple matTooltip="Edit" matTooltipPosition="above" [routerLink]="['/sales/product/'+product.uniqueid]" class="fa fa-pencil px-4 kb-table-action-icon rounded"></i>
                      <i mat-ripple matTooltip="Duplicate" matTooltipPosition="above"  (click)="openDialog(dupdialog,product)" class="far fa-copy px-4 kb-table-action-icon rounded"></i>
                      <i mat-ripple matTooltip="Delete" matTooltipPosition="above" (click)="openDialog(deldialog, product)" class="fa fa-trash-alt px-4 kb-table-action-icon kb-icon-del rounded"></i>
                    </span>
                  </td>                        
                </tr>
              </tbody>
            </table>
          </div>
        </div>
    </div>
    
  