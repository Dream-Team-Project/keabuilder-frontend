<ng-template #dialog>
  <h1 mat-dialog-title class="kb-danger">Delete Funnel</h1>
  <div mat-dialog-content>
      Would you like to delete <span class="text-danger">{{delpage.name}}</span> funnel?<br>
      All data with funnel steps will be deleted and can't be restored!
  </div>
  <div mat-dialog-actions class="justify-content-end">
      <mat-form-field class="kb-full-width" appearance="fill">
        <mat-label>Confirm Password</mat-label>
        <input type="text" name="confirmpass" matInput [(ngModel)]="confirmpass">
      </mat-form-field>
      <button mat-button mat-dialog-close class="text-info">No</button>
      <button mat-button mat-dialog-close cdkFocusInitial class="text-danger" (click)="restoredeleteme(delpage,'delete')">Yes</button>
  </div>
</ng-template>

<div id="archivesteps">
  <mat-progress-bar *ngIf="searching" mode='indeterminate'></mat-progress-bar>
    <div class="container-fluid">
        <div class="row whitefunnel pb-5">


            <div class="col-md-12 adjustarchivesort">
              <mat-form-field  appearance="fill" class="w-100">
                <mat-label>Search Archive Funnels</mat-label>
                <input matInput type="text" (keyup)="applyFilter($event)" id="offer-search" placeholder="Search by Funnel name, created at...">
                <i class="fa-solid fa-magnifying-glass"></i>
              </mat-form-field>
  
              <mat-form-field appearance="fill" class="kb-full-width ">
                <mat-label>Showing Archive for</mat-label>
                <mat-select name="showingcontacts" [(ngModel)]="showingcontacts" (ngModelChange)="applykbfilter()">
                  <mat-option value="7 DAY">Last 7 Days</mat-option>
                  <mat-option value="30 DAY">Last 30 Days</mat-option>
                  <mat-option value="2 MONTH">Last 2 Months</mat-option>
                  <mat-option value="1 YEAR">This Year</mat-option>
                  <mat-option value="all">All Time</mat-option>
                </mat-select>
              </mat-form-field>
            </div>

            <div class="col-md-12">

                <div class="mat-elevation-z8">
                  <table mat-table [dataSource]="dataSource" matSort>
                
                    <ng-container matColumnDef="name">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Funnel Name </th>
                      <td mat-cell *matCellDef="let row"> {{row.name}} </td>
                    </ng-container>
                
                    <ng-container matColumnDef="created_at">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Created At </th>
                      <td mat-cell *matCellDef="let row"> {{datecusfilter(row.created_at)}} </td>
                    </ng-container>

                    <ng-container matColumnDef="archive_reason">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Archive Reason </th>
                      <td mat-cell *matCellDef="let row"> {{row.archive_reason}} </td>
                    </ng-container>
                
                    <ng-container matColumnDef="updated_at">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Actions </th>
                      <!-- <td mat-cell *matCellDef="let row">
                        <button mat-raised-button class="mr-2" (click)="restoredeleteme(row.uniqueid,'restore')" ><span class="keadnmob">Restore</span> <i class="fa fa-trash-restore" aria-hidden="true"></i></button>
                        <button mat-raised-button (click)="openDialog(row.id)" ><span class="keadnmob">Delete</span> <i class="far fa-trash-alt" aria-hidden="true"></i></button>
                      </td> -->

                      <td mat-cell *matCellDef="let row">
                        <button mat-raised-button [color]="'accent'" class="mr-2" (click)="restoredeleteme(row,'restore')">Restore <i
                            class="fa fa-trash-restore" aria-hidden="true"></i></button>
                        <button mat-raised-button [color]="'danger'" (click)="openDialog(dialog, row, '')">Delete <i class="far fa-trash-alt"
                            aria-hidden="true"></i></button>
                      </td>
                    </ng-container>
                
                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="selection.toggle(row)" ></tr>
                
                    <!-- Row shown when there is no matching data. -->
                    <tr class="mat-row" *matNoDataRow>
                      <td class="mat-cell" colspan="4">No data matching the filter "{{searchval}}"</td>
                    </tr>
                  </table>
                
                  <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>
                </div>

            </div>
        </div>
    </div>
</div>